<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploiting GraphQL Batching | Zarqen Research</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --dark-bg: #000000;
            --darker-bg: #0a0a0f;
            --card-bg: #0d0d12;
            --grid-line: #1a1a2e;
            --text-primary: #ffffff;
            --text-secondary: #8892b0;
            --accent-blue: #00f0ff;
            --accent-cyan: #0ff;
            --accent-purple: #a855f7;
            --accent-pink: #ff006e;
            --glow-blue: rgba(0, 240, 255, 0.4);
            --glow-purple: rgba(168, 85, 247, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', 'Helvetica Neue', Arial, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
            animation: gridMove 30s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(60px, 60px); }
        }

        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(100px);
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
        }

        .orb-1 {
            top: -200px;
            right: -200px;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, var(--accent-purple), transparent);
            animation: float 20s ease-in-out infinite;
        }

        .orb-2 {
            bottom: -300px;
            left: -300px;
            width: 700px;
            height: 700px;
            background: radial-gradient(circle, var(--accent-blue), transparent);
            animation: float 25s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(50px, 50px) scale(1.1); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 60px;
            position: relative;
            z-index: 2;
        }

        header {
            padding: 30px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            z-index: 100;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--text-primary);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 40px;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            letter-spacing: 0.3px;
            transition: color 0.2s ease;
            font-weight: 500;
        }

        .nav-links a:hover {
            color: var(--text-primary);
        }

        .back-link {
            padding: 80px 0 40px;
        }

        .back-link a {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .back-link a:hover {
            color: var(--accent-blue);
            gap: 12px;
        }

        .article-wrapper {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 80px;
            padding-bottom: 100px;
        }

        article {
            max-width: 780px;
        }

        .article-header {
            margin-bottom: 60px;
        }

        .article-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .category-badge {
            display: inline-block;
            padding: 6px 14px;
            background: rgba(0, 240, 255, 0.08);
            border: 1px solid rgba(0, 240, 255, 0.2);
            border-radius: 16px;
            font-size: 12px;
            color: var(--accent-blue);
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .article-date {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .read-time {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .article-title {
            font-size: 52px;
            font-weight: 700;
            line-height: 1.15;
            letter-spacing: -1.5px;
            margin-bottom: 24px;
        }

        .article-subtitle {
            font-size: 20px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 40px;
        }

        .author-info {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 24px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .author-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
        }

        .author-details h4 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .author-details p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .article-content {
            margin-top: 60px;
        }

        .article-content h2 {
            font-size: 32px;
            font-weight: 700;
            margin-top: 60px;
            margin-bottom: 20px;
            letter-spacing: -0.5px;
        }

        .article-content h3 {
            font-size: 24px;
            font-weight: 600;
            margin-top: 48px;
            margin-bottom: 16px;
            letter-spacing: -0.3px;
        }

        .article-content p {
            font-size: 17px;
            line-height: 1.8;
            margin-bottom: 24px;
            color: rgba(255, 255, 255, 0.9);
        }

        .article-content ul,
        .article-content ol {
            margin: 24px 0;
            padding-left: 28px;
        }

        .article-content li {
            font-size: 17px;
            line-height: 1.8;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .article-content a {
            color: var(--accent-blue);
            text-decoration: none;
            border-bottom: 1px solid rgba(0, 240, 255, 0.3);
            transition: all 0.2s ease;
        }

        .article-content a:hover {
            border-bottom-color: var(--accent-blue);
        }

        .code-block {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 28px;
            margin: 32px 0;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.7;
            overflow-x: auto;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .code-language {
            font-size: 11px;
            color: var(--text-secondary);
            letter-spacing: 1px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .copy-btn {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background: rgba(0, 240, 255, 0.1);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .code-content {
            color: var(--text-secondary);
        }

        .code-comment { color: #6a9955; }
        .code-string { color: #ce9178; }
        .code-keyword { color: var(--accent-purple); }
        .code-function { color: var(--accent-cyan); }

        .info-box {
            background: rgba(0, 240, 255, 0.05);
            border: 1px solid rgba(0, 240, 255, 0.2);
            border-left: 4px solid var(--accent-blue);
            border-radius: 8px;
            padding: 24px 28px;
            margin: 32px 0;
        }

        .info-box-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 12px;
        }

        .info-box p {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.85);
            line-height: 1.7;
            margin: 0;
        }

        .warning-box {
            background: rgba(255, 0, 110, 0.05);
            border: 1px solid rgba(255, 0, 110, 0.2);
            border-left: 4px solid var(--accent-pink);
        }

        .warning-box .info-box-title {
            color: var(--accent-pink);
        }

        .image-block {
            margin: 48px 0;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .image-placeholder {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(0, 240, 255, 0.2));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 64px;
        }

        .image-caption {
            padding: 16px 20px;
            background: var(--card-bg);
            font-size: 14px;
            color: var(--text-secondary);
            text-align: center;
        }

        .blockquote {
            border-left: 4px solid var(--accent-blue);
            padding-left: 28px;
            margin: 32px 0;
            font-size: 20px;
            font-style: italic;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .sidebar {
            position: sticky;
            top: 120px;
            height: fit-content;
        }

        .toc {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 28px 24px;
            margin-bottom: 24px;
        }

        .toc-title {
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list li {
            margin-bottom: 12px;
        }

        .toc-list a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            line-height: 1.5;
            transition: color 0.2s ease;
            display: block;
        }

        .toc-list a:hover,
        .toc-list a.active {
            color: var(--accent-blue);
        }

        .share-box {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 28px 24px;
        }

        .share-title {
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .share-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .share-btn:hover {
            background: rgba(0, 240, 255, 0.05);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .related-posts {
            margin-top: 80px;
            padding-top: 80px;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }

        .related-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 40px;
            letter-spacing: -0.5px;
        }

        .related-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
        }

        .related-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 28px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
        }

        .related-card:hover {
            border-color: rgba(0, 240, 255, 0.3);
            transform: translateY(-4px);
        }

        .related-card-category {
            font-size: 11px;
            color: var(--accent-blue);
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            margin-bottom: 12px;
        }

        .related-card-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .related-card-date {
            font-size: 13px;
            color: var(--text-secondary);
        }

        footer {
            padding: 60px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            margin-top: 100px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-text {
            font-size: 13px;
            color: var(--text-secondary);
            letter-spacing: 0.3px;
        }

        .footer-links {
            display: flex;
            gap: 40px;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 13px;
            transition: color 0.2s ease;
        }

        .footer-links a:hover {
            color: var(--text-primary);
        }

        @media (max-width: 1200px) {
            .container { padding: 0 40px; }
            .article-wrapper { grid-template-columns: 1fr; }
            .sidebar { position: relative; top: 0; }
            .related-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .article-title { font-size: 36px; }
            .article-content h2 { font-size: 26px; }
            .article-content h3 { font-size: 20px; }
            .related-grid { grid-template-columns: 1fr; }
            .nav-links { display: none; }
            .footer-content { flex-direction: column; gap: 24px; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="grid-overlay"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <header>
        <div class="container">
            <nav>
                <a href="index.html" class="logo">Zarqen</a>
                <ul class="nav-links">
                    <li><a href="index.html#services">Services</a></li>
                    <li><a href="index.html#expertise">Expertise</a></li>
                    <li><a href="index.html#process">Methodology</a></li>
                    <li><a href="blogs.html">Research</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="back-link">
            <a href="blog.html">‚Üê Back to Research</a>
        </div>

        <div class="article-wrapper">
            <article>
                <div class="article-header">
                    <div class="article-meta">
                        <span class="category-badge">Web Security</span>
                        <span class="article-date">December 15, 2024</span>
                        <span class="read-time">‚Ä¢ 12 min read</span>
                    </div>
                    <h1 class="article-title">Exploiting GraphQL Batching: A Deep Dive into Rate Limit Bypasses</h1>
                    <p class="article-subtitle">GraphQL batching can be a developer's best friend for performance, but a nightmare for security. We discovered a critical vulnerability affecting major SaaS platforms that allowed unlimited API calls through batch query manipulation.</p>
                    <div class="author-info">
                        <div class="author-avatar">AS</div>
                        <div class="author-details">
                            <h4>Admin</h4>
                            <p>Security Researcher</p>
                        </div>
                    </div>
                </div>

                <div class="article-content">
                    <p>During a recent security assessment of a high-profile SaaS platform, we discovered a critical vulnerability that allowed attackers to bypass rate limiting entirely. The culprit? GraphQL batching‚Äîa feature designed to improve performance that, when implemented incorrectly, can completely undermine security controls.</p>

                    <h2>The Problem with GraphQL Batching</h2>

                    <p>GraphQL batching allows clients to send multiple queries in a single HTTP request, reducing network overhead and improving application performance. However, most rate limiting implementations only count HTTP requests, not the individual operations within them.</p>

                    <div class="info-box">
                        <div class="info-box-title">
                            <span>üí°</span>
                            <span>Key Insight</span>
                        </div>
                        <p>If your API allows 100 requests per minute but accepts batched queries with no limit on batch size, an attacker can effectively make 10,000+ operations per minute by batching 100 queries per request.</p>
                    </div>

                    <h3>Discovery Process</h3>

                    <p>Our initial reconnaissance revealed the target application used GraphQL for its primary API. Standard testing showed aggressive rate limiting‚Äîwe were blocked after just 50 requests within a minute. However, the GraphQL endpoint accepted array-based batch queries.</p>

                    <p>We crafted a simple test to validate our hypothesis:</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">JSON</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-content"><span class="code-keyword">POST</span> /graphql HTTP/1.1
Host: target-api.example.com
Content-Type: application/json

[
  {
    <span class="code-string">"query"</span>: <span class="code-string">"{ user(id: 1) { email } }"</span>
  },
  {
    <span class="code-string">"query"</span>: <span class="code-string">"{ user(id: 2) { email } }"</span>
  },
  <span class="code-comment">// ... repeat 98 more times</span>
]</div>
                    </div>

                    <h2>Exploitation Methodology</h2>

                    <p>Once we confirmed batching was enabled without proper controls, we developed a systematic exploitation approach:</p>

                    <div class="image-block">
                        <div class="image-placeholder">üìä</div>
                        <div class="image-caption">Figure 1: Attack flow diagram showing batch query exploitation</div>
                    </div>

                    <h3>Phase 1: Enumeration</h3>

                    <p>We used batch queries to enumerate user IDs at scale. By batching 500 queries per request, we enumerated 50,000 user records in just 100 requests‚Äîwell under the rate limit threshold.</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">Python</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-content"><span class="code-keyword">import</span> requests
<span class="code-keyword">import</span> json

<span class="code-keyword">def</span> <span class="code-function">batch_enumerate_users</span>(start_id, end_id, batch_size=500):
    queries = []
    <span class="code-keyword">for</span> user_id <span class="code-keyword">in</span> <span class="code-function">range</span>(start_id, end_id):
        queries.append({
            <span class="code-string">"query"</span>: <span class="code-string">f"{{ user(id: {user_id}) {{ id email username }} }}"</span>
        })
        
        <span class="code-keyword">if</span> <span class="code-function">len</span>(queries) == batch_size:
            response = requests.<span class="code-function">post</span>(
                <span class="code-string">"https://api.example.com/graphql"</span>,
                json=queries
            )
            <span class="code-comment"># Process results...</span>
            queries = []</div>
                    </div>

                    <h3>Phase 2: Data Extraction</h3>

                    <p>With valid user IDs identified, we escalated to extracting sensitive information. Each batched request yielded hundreds of user profiles, including email addresses, phone numbers, and account metadata.</p>

                    <div class="warning-box info-box">
                        <div class="info-box-title">
                            <span>‚ö†Ô∏è</span>
                            <span>Security Impact</span>
                        </div>
                        <p>This vulnerability resulted in a CVSS score of 8.6 (High). An attacker could enumerate and exfiltrate the entire user database in minutes, bypassing all rate limiting controls.</p>
                    </div>

                    <h2>Real-World Impact</h2>

                    <p>After responsible disclosure, we learned this vulnerability pattern affected multiple major platforms. The common thread was a disconnect between security and development teams:</p>

                    <ul>
                        <li>Developers implemented batching for legitimate performance gains</li>
                        <li>Security controls were applied at the HTTP layer, not the operation layer</li>
                        <li>No one tested whether rate limits applied to batched operations</li>
                        <li>Monitoring systems counted requests but not individual query executions</li>
                    </ul>

                    <blockquote class="blockquote">
                        "The most dangerous vulnerabilities aren't in broken code‚Äîthey're in the gaps between features and security controls."
                    </blockquote>

                    <h2>Defense Strategies</h2>

                    <p>Based on our research, we recommend several defense-in-depth strategies for GraphQL implementations:</p>

                    <h3>1. Operation-Level Rate Limiting</h3>

                    <p>Implement rate limiting that counts individual GraphQL operations, not just HTTP requests. This ensures batched queries are properly throttled.</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">JavaScript</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-content"><span class="code-keyword">const</span> rateLimiter = <span class="code-keyword">new</span> <span class="code-function">GraphQLRateLimiter</span>({
  <span class="code-comment">// Count each operation in a batch separately</span>
  identifyContext: (context) => context.user.id,
  countPerOperation: <span class="code-keyword">true</span>,
  max: 100,
  window: <span class="code-string">'1m'</span>
});</div>
                    </div>

                    <h3>2. Batch Size Limits</h3>

                    <p>Enforce strict limits on batch query sizes. Even with operation-level rate limiting, unbounded batch sizes can enable resource exhaustion attacks.</p>

                    <h3>3. Query Complexity Analysis</h3>

                    <p>Implement query complexity scoring that accounts for nested fields, array sizes, and computational cost. Reject queries exceeding complexity thresholds.</p>

                    <h3>4. Monitoring and Alerting</h3>

                    <p>Deploy monitoring that tracks operation counts, not just request counts. Alert on anomalous patterns such as consistently maxed-out batch sizes or sudden spikes in operation volume.</p>

                    <h2>Conclusion</h2>

                    <p>GraphQL batching is a powerful feature, but it requires careful security consideration. The vulnerability we discovered wasn't the result of a coding error‚Äîit emerged from the interaction between a performance optimization and security controls that weren't designed to account for it.</p>

                    <p>As security professionals, we must think beyond individual features and consider how they interact with the broader security architecture. Rate limiting, authentication, and authorization must be applied consistently across all entry points and operation types.</p>

                    <div class="info-box">
                        <div class="info-box-title">
                            <span>üîê</span>
                            <span>Takeaway</span>
                        </div>
                        <p>Security controls must evolve alongside application features. When implementing new capabilities like GraphQL batching, always validate that existing security measures remain effective.</p>
                    </div>
                </div>

                <div class="related-posts">
                    <h2 class="related-title">Related Research</h2>
                    <div class="related-grid">
                        <a href="#" class="related-card">
                            <div class="related-card-category">Web Security</div>
                            <h3 class="related-card-title">OAuth 2.0 Implementation Flaws: A Practical Exploitation Guide</h3>
                            <div class="related-card-date">November 15, 2024</div>
                        </a>
                        <a href="#" class="related-card">
                            <div class="related-card-category">API Security</div>
                            <h3 class="related-card-title">Server-Side Request Forgery: Modern Bypass Techniques</h3>
                            <div class="related-card-date">October 25, 2024</div>
                        </a>
                        <a href="#" class="related-card">
                            <div class="related-card-category">Cloud Security</div>
                            <h3 class="related-card-title">AWS IAM Policy Mistakes That Lead to Account Compromise</h3>
                            <div class="related-card-date">December 10, 2024</div>
                        </a>
                    </div>
                </div>
            </article>

            <aside class="sidebar">
                <div class="toc">
                    <div class="toc-title">Table of Contents</div>
                    <ul class="toc-list">
                        <li><a href="#problem" class="active">The Problem with GraphQL Batching</a></li>
                        <li><a href="#discovery">Discovery Process</a></li>
                        <li><a href="#exploitation">Exploitation Methodology</a></li>
                        <li><a href="#impact">Real-World Impact</a></li>
                        <li><a href="#defense">Defense Strategies</a></li>
                        <li><a href="#conclusion">Conclusion</a></li>
                    </ul>
                </div>

                <div class="share-box">
                    <div class="share-title">Share Article</div>
                    <div class="share-buttons">
                        <a href="#" class="share-btn">
                            <span>ùïè</span>
                            <span>Share on X</span>
                        </a>
                        <a href="#" class="share-btn">
                            <span>in</span>
                            <span>Share on LinkedIn</span>
                        </a>
                        <a href="#" class="share-btn">
                            <span>‚úâ</span>
                            <span>Share via Email</span>
                        </a>
                        <a href="#" class="share-btn">
                            <span>üîó</span>
                            <span>Copy Link</span>
                        </a>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-text">¬© 2025 Zarqen. All rights reserved.</div>
                <div class="footer-links">
                    <a href="#">Privacy</a>
                    <a href="#">Terms</a>
                    <a href="blog.html">Research</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const codeBlock = this.closest('.code-block');
                const codeContent = codeBlock.querySelector('.code-content').textContent;
                
                navigator.clipboard.writeText(codeContent).then(() => {
                    this.textContent = 'Copied!';
                    setTimeout(() => {
                        this.textContent = 'Copy';
                    }, 2000);
                });
            });
        });

        document.querySelectorAll('.toc-list a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelectorAll('.toc-list a').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        document.querySelectorAll('.share-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const text = this.querySelector('span:last-child').textContent;
                
                if (text.includes('Copy Link')) {
                    navigator.clipboard.writeText(window.location.href).then(() => {
                        alert('Link copied to clipboard!');
                    });
                } else if (text.includes('X')) {
                    window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(document.title)}`, '_blank');
                } else if (text.includes('LinkedIn')) {
                    window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}`, '_blank');
                } else if (text.includes('Email')) {
                    window.location.href = `mailto:?subject=${encodeURIComponent(document.title)}&body=${encodeURIComponent(window.location.href)}`;
                }
            });
        });
    </script>
</body>
</html>